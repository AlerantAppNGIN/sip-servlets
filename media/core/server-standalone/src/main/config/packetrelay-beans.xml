<?xml version="1.0" encoding="UTF-8"?>

<deployment xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:jboss:bean-deployer:2.0 bean-deployer_2_0.xsd"
	xmlns="urn:jboss:bean-deployer:2.0">

	<bean name="PR-RxChannelFactory"
		class="org.mobicents.media.server.resource.ChannelFactory"/>

	<bean name="PR-TxChannelFactory"
		class="org.mobicents.media.server.resource.ChannelFactory"/>


	<bean name="PacketRelayConnectionFactory"
		class="org.mobicents.media.server.ConnectionFactory">
		<property name="txChannelFactory">
			<map class="java.util.Hashtable" keyClass="java.lang.String"
				valueClass="org.mobicents.media.server.resource.ChannelFactory">
				<entry>
					<key>audio</key>
					<value>
						<inject bean="PR-TxChannelFactory" />
					</value>
				</entry>
			</map>
		</property>
		<property name="rxChannelFactory">
			<map class="java.util.Hashtable" keyClass="java.lang.String"
				valueClass="org.mobicents.media.server.resource.ChannelFactory">
				<entry>
					<key>audio</key>
					<value>
						<inject bean="PR-RxChannelFactory" />
					</value>
				</entry>
			</map>
		</property>
	    <property name="connectionStateManager">
           <inject bean="ConnectionStateManager"/>
        </property>		
	</bean>

	<bean name="PacketRelayBridgeFactory"
		class="org.mobicents.media.server.impl.resource.prelay.BridgeFactory">
		<property name="name">packet.relay</property>
                <property name="dspFactory"><inject bean="DSP"/></property>
	</bean>

	<bean name="PacketRelayEndpoint"
		class="org.mobicents.media.server.EndpointImpl">
		<property name="localName">
			/mobicents/media/packetrelay/[1..10]
		</property>
		<property name="timer">
			<inject bean="Timer" />
		</property>
		<property name="rtpFactory">
			<inject bean="RTPFactory" />
		</property>
		<property name="connectionFactory">
			<inject bean="PacketRelayConnectionFactory" />
		</property>
		<property name="groupFactory">
			<inject bean="PacketRelayBridgeFactory" />
		</property>
	</bean>


</deployment>